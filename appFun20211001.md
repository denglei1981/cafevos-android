#  App事件  #

#####*20230118更新*
更新时间 | 更新内容  
------- | -------  
2021.10.01 | 整理H5交互时间
2021.10.27|完善APP事件
2021.11.2|增加跳邀请新用户
2021.11.8|H5设置状态栏字体颜色
2021.11.18|跳意见反馈增加tagId
2021.11.26|增加跳转车主认证详情
2021.12.02|意见反馈参数
2022.09.08｜增加历史新增方法
2023.01.18|新增获取h5临时授权Code

### <font color="#FF0000">所有方法均需用FORDApp调用， 回调方法参考登录回调</font>

##### 1.加密

```
var result = FORDAPP.encryKey("16位随机字符串key")
```

##### 2.解密

```
var result = FORDAPP.decrypt("需要解密的字符串","16位随机字符串key")
```

##### 3.签名
```
// type String: 0埋点签名  1为其他接口签名
var result = FORDApp.sign(str, type)
```

##### 4.获取token
```
var token = FORDApp.getToken()
```
##### 5.关闭webview
```
// 0或者不传 关闭当前页面
//
FORDApp.closePage(value:Int)
```

##### 6.打开APP子页面
```
var param = {"jumpDataType": 1, "jumpDataValue": "https://www.baidu.com"}
FORDApp.openPage(JSON.stringify(param))
```
跳转类型集合
----------

type | value | 说明
-----|-----|-----
'99'  |=> |'不跳转',
'100' |=> |'登录页面',
 '101' |=> |'发现',
 '102' |=> |'社区',
 '103' |=> |'爱车',
 '104' |=> |'商城',
 '105' |=> |'我的',
 '107'|=>|H5页面，需要登录，需要绑定手机号
'108'|type|聚合搜索【type传0-4，默认0】
'109'|goodsInfo|商品订单确认【砍价功能】
 '10000'  |=> |'H5外部跳转(打开浏览器)',
 '1'   |h5链接或参数 |'H5页面',
 '2'   |artId |'资讯详情',
 '3'   |spuId |'商品详情',
 '4'   |postsId |'帖子详情',
 '5'   |orderNo |商城订单详情,
 '6    | circleId| '圈子详情',
 '7'    | => | '专题列表',
 '8'    |specialTopicId| '专题详情',
 '9'    |topicId| '话题详情',
 '10'  |=> |'成长值详情',
'11'   |{"tagId": "28","content": "订单号"} |'填写意见反馈'【默认选中tagId标签】
 '12'    |=> | '去发布调查',
 '13'    |=> | '去发布活动',
 '14'    |=> | '去发帖'【跳转到社区页面】,
 '16'  |=> |任务中心,
 '17'  |=> |'车主认证'【此功能暂未开放】,
 '18'    |=> | '绑定手机号',
 '19'  |=> |'小程序',
 '20'  |=> |'地址管理',
 '21'    |=> | '设置',
 '22' |=>|会员身份,
 '23'  |=> |'我的发布',
 '24'  |=> |'我的消息',
 '25'  |=> |'我的关注',
 '26'  |=> |'我的活动',
 '27' |=>|'我的收藏',
 '28'  |=> |'我的圈子',
 '29'  |=> |我的勋章,
 '30'   |=>  |积分纪录,
 '32'  |=> |‘成长值',
 '34'  |=> |用户个人信息页面,
 '35'  |=> |'他人主页',
 '36'  |=> |聚合订单列表页, 
 '37'|=>|签到
'38'|=>|我的足迹
 '39'|=>|常见问题
'40'|=>|我的粉丝
'42'|=>|意见反馈记录
'44'|=>|邀请新用户
'47'|messageType|(1->系统消息 2->互动消息 3->交易消息) |消息列表
'48'|=>|秒杀列表,
'49'|=>|福特员工认证,
‘50’|{"vin":"Lsssdowie","status":1}|跳转车主认证详情,
'52'|=>|商城订单列表
'55'|=>|月签到详情
'59'|toast消息|弹出一个toast内容
'60'|{"content":"弹框的内容","buttons":[{"btName":"按钮内容","jumpData":{"jumpDataType":"xx","jumpDataValue":"xx"}}]}|弹出一个弹框，内容，按钮及跳转在value中返回
'61'|=>|扫一扫
'71'|=>|跳转新版意见反馈页面
'73'|=>|需要位置权限的H5
'110'|orderNo|商城支付确认页面
'111'|{"spuId": "维保商品ID","spuPageType": "MAINTENANCE"}|商品评价列表
'112'|{"orderNo": "M0565984864114180096","skuList":[{"skuImg":"pg","mallOrderSkuId":104,"mallMallspuId":1292,"spuName": "石头"}],"reviewEval": false}|商品订单评价
'113'|=>|话题列表
'114'|被查看人的问答参与表id|我的问答它的问答
'115'|technicianId|自己可以编辑技术详情的主页
'116'|=>|提问
'117'|{"circleId":"circleId","isApply":"isApply"}|圈子成员列表
'118'|=>|优惠券列表
'119'|=>|购物车
'120'|=>|申请发票
'121'|json|申请退款
'122'|=>|跳优惠券弹窗
'123'|=>|查看发票详情
'124'|=>|整单退退款进度
'125'|=>|单个sku退款申请
'126'|=>|单个sku 退款进度
'127'|=>|多包裹信息
'128'|=>|使用优惠券
'129'|=>|爱车养护
'130'|=>|我的勋章
'131'|=>|发帖----///发帖 1、图文      2、长贴       3、视频
'132'|=>|
'133'|=>|我圈子分类页
'134'|=>|创建圈子
'135'|=>|圈子热门榜单页
'136'|=>|
'137'|=>|
'138'|=>|商城-推荐榜单-榜单列表页：type = 138 value = 榜单名称
'139'|=>|勋章详情
'140'|=>|新增收货地址



##### 7.跳转到app登陆界面

```
function loginCallBack(a) {
		//登录回调
      alert("字串回调-" + a)
}
FORDApp.loginApp("loginCallBack")
```

##### 8.IOS的禁止回弹效果
```
// 仅ios有此方法
FORDApp.setBounces(false)
```

##### 9.上传图片
```
/**
* 上传图片，img = base64串，
* callback = 回调一个http连接
**/
FORDApp.uploadImgData(img, "callback")

```

##### 10.复制到剪切板
```
FORDApp.copyText("")
```

##### 11.分享
```
var data = {
  	shareTitle:"", // 分享标题【必传】
	shareUrl:"", // 分享链接【必传】
	shareImg:"", // 分享icon【必传】
	shareDesc:"",  // 分享描述【必传】
	shareType: 1, // 
	type:'3',//
	bizId,'222',//分享回调用
	isImg: "0", // 是否为分享纯图片（1 是 0 否）
	isMiniProgram: "1", // 是否分享微信小程序（可选）
}
FORDApp.shareTo(JSON.stringify(data), "shareCallBack")
```

##### 12.头部设置
```
// title: 标题  style:右上角接受自定义（包括样式自定义） subcallback:点击事件回调
var style = {
	text = "标题"
	color = "文字颜色"
	image = "图片地址 / 有标题再设置图片地址不会生效"
}
FORDApp.setNavTitle(title, JSON.stringify(style), 'callback')
```

##### 13.支付
```
/**
 * payCode: 1-支付宝， 2-微信
 * param: 支付字符串
 * callback：支付成功回调
 */
FORDApp.openPay(payCode, param, "callback")
```

#### 14.显示隐藏导航栏
```
FORDApp.isNavigationHidden(bool)
```


#### 15.选择一张图片，返回base64串
```
/**
 * 选择一张图片
 * @param 回调，传回一张图片的base64串
 */
FORDApp.choseImg("callback")
```

#### 16. 缓存到本地一个json
```
 FORDApp.setSessionStorage(key, value)
```
#### 16. 从本地读取缓存
```
let json = FORDApp.getSessionStorage(key)
```
#### 17. 删除本地缓存
```
FORDApp.delegateSessionStorage(key)
```
#### 18. 上传based64图片
```
function callback(imgPath) {
	// path
}
FORDApp.uploadImgData(imgString, "callback")
```

#### 19. 获取位置信息
```
var callbackResultStr = {"latitude": fir.latitude,
                         "longitude": fir.longitude,
                         "cityCode": code,
                         "address": address}
FORDApp.getLocation("callback")
```

#### 20. 获取导航高度
```
var height = FORDApp.getNaviHeight()
```

#### 21 图片浏览
```
/**
* imgArr 图片数组
* index 当前显示第几个
*/
var imgArr = [String]
FORDApp.showPhotoBrowser(JSON.stringify(imgArr), 0)
```

#### 22 选择地址
```
FORDApp.selectAddress("callback")
```
#### 23 获取app版本
```
var version = FORDApp.getAppVersion()
```

#### 24. 显示404页面
```
FORDApp.showError404()
```

#### 25. 获取用户信息
```
FORDApp.getMyInfo("callback")
```
#### 26. 扫码
```
FORDApp.showScan("callbacl")
```

#### 27. 保存图片
```
FORDApp.saveImg(imgUrl, "callback")
```
#### 28. 获取手机信息
```
/**
{"deviceId": uuid,
 "brand": "苹果",
 "model": "iphone 11"}
*/
var result = FORDApp.getDeviceInfo()
```

#### 29. 设置状态栏字体的颜色
```
/**
* color 0是白，1是黑
     */
    @JavascriptInterface
    fun setStatusBarTextColor(color:Int)
```
#### 30. 设置状态栏是否透明 不透明默认白色
```
/**
* [isTransparent]是否透明
     */
    @JavascriptInterface
    fun setStatusBarIsTransparent(isTransparent:Boolean)
```
#### 31. 打开PDF文件
```
/**
* [pdfUrl]pdf文件地址
     */
    @JavascriptInterface
    fun opePdf(pdfUrl: String)
```
#### 32. 小程序分享
```
/**
     * 小程序分享
     * [webpageUrl]兼容低版本的网页链接 限制长度不超过 10KB
     * [miniprogramType]正式版:0，测试版:1，体验版:2
     * [userName]小程序原始id（gh_d43f693ca31f）
     * [path]小程序页面路径；对于小游戏，可以只传入 query 部分，来实现传参效果，如：传入 "?foo=bar"
     * [title] 小程序消息title
     * [description]小程序消息desc
     * * thumbData 小程序消息封面图片，小于128k ByteArray(byte[])
     * [imgPath]小程序消息封面图片，imgPath 图片路径 没有传 null
     * [shareCallBack]回调
     */
    @JavascriptInterface
    fun shareSmallProgram(
        webpageUrl: String,
        miniprogramType: Int,
        userName: String,
        path: String,
        title: String,
        description: String,
        imgPath: String?,
        shareCallBack: String
    )
```
#### 33. 银联支付
```
/**
     * 银联支付
     * [payType]支付类型 1支付宝、2 微信、3云闪付
     * [appPayRequest]拉起支付的参数（具体参考对应文档）
     * [callback]支付回调
     * [serverMode] 云闪付使用 为后台环境标识，不传或者null默认使用“00”生产环境
     */
     
    fun openUnionPay(payType: Int, appPayRequest: String, callback: String)
    
    fun openUnionPay(payType: Int, appPayRequest: String, callback: String, serverMode: String?)
    
```

#### 34. 打开相机
```
     
    fun openCamera(callback: String)    
    /**
     * 打开相机
     * [callback]js回调方法
     * [isEnableCrop]是否裁剪
     * [isCompress]是否压缩 开启后默认小于500不压缩
     * 返回 base64Str
     * */
    @JavascriptInterface
    fun openCamera(isEnableCrop: Boolean = true, isCompress: Boolean = true, callback: String)
```

#### 35. 打开相册
```
     
    fun openPhoto(maxNum: Int = 1, callback: String)
    /**
     * 打开相册
     * [maxNum]最大选择图片数量
     * [callback]返回选取图片的base64字符串用英文逗号分割（,）
     * [isEnableCrop]是否裁剪
     */
    @JavascriptInterface
    fun openPhoto(maxNum: Int = 1, isEnableCrop: Boolean = true, callback: String)
    
```

#### 36. 获取用户认证车辆列表
```
     
    fun getUserApproveCar(callback: String)    
```
#### 37. 获取当前默认车辆的vin
```
     
    fun getCurVin(callback: String)    
```
#### 38. H5通过传入入参和url相对路径请求原生接口
```
     
    fun getUrlResult(body: String, url: String, callBack: String)
```

#### 39. 获取系统版本号
```
     
    fun getSystemVersion()
```
#### 40. 返回网页上一级
```
  fun webGoBack()
```
### 41. 获取h5临时授权Code
```
callback :回调方法名，返回code
fun getAccessCode(clientId:String,redirectUrl:String,callback: String)
```